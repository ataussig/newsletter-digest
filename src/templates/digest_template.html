<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Newsletter Digest ‚Äì {{ date }}</title>
</head>
<body style="margin:0; padding:0; background:#f0f2f5; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">

<!-- Outer wrapper -->
<table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="background:#f0f2f5; padding:24px 0;">
<tr><td align="center">

<!-- Main content column ‚Äì 640 px max -->
<table role="presentation" cellpadding="0" cellspacing="0" width="640" style="width:100%; max-width:640px;">

<!-- ‚îÄ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ‚îÄ -->
<tr>
<td style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); border-radius:12px 12px 0 0; padding:32px 28px; text-align:center;">
  <h1 style="margin:0 0 6px; color:#fff; font-size:24px; font-weight:700; letter-spacing:-0.5px;">üì∞ Your Daily Newsletter Digest</h1>
  <p style="margin:0; color:rgba(255,255,255,0.85); font-size:14px;">{{ date }} &middot; {{ total_articles }} article{{ 's' if total_articles != 1 }} from {{ newsletter_count }} newsletter{{ 's' if newsletter_count != 1 }}</p>
</td>
</tr>

<!-- ‚îÄ‚îÄ‚îÄ SECTIONS ‚îÄ‚îÄ‚îÄ -->
<!--
  sections is an OrderedDict: section_name ‚Üí list of article dicts.
  Essays section: each article has title, url, summary, newsletter_name.
  Link sections:  each article has title, url, blurb, newsletter_name.
  Empty sections are already stripped by main.py so we render everything.
-->

{% for section_name, articles in sections.items() %}
<tr>
<td style="background:#fff; padding:24px 28px; border-left:1px solid #e2e4e8; border-right:1px solid #e2e4e8; {% if loop.last %}border-radius:0 0 12px 12px;{% endif %}">

  <!-- Section header -->
  {% if section_name == 'Essays' %}
    <!-- Essays gets a distinct accent -->
    <h2 style="margin:0 0 18px; font-size:17px; color:#1a1a2e;">
      <span style="display:inline-block; background:linear-gradient(135deg,#667eea,#764ba2); color:#fff; padding:4px 12px; border-radius:4px; font-weight:600;">üìù Essays</span>
    </h2>
  {% else %}
    <!-- Category sections get a subtle pill label -->
    <h2 style="margin:0 0 18px; font-size:17px; color:#1a1a2e;">
      <span style="display:inline-block; background:#eef0f7; color:#5a6abf; padding:4px 12px; border-radius:4px; font-weight:600; font-size:14px;">{{ section_name }}</span>
    </h2>
  {% endif %}

  <!-- ‚îÄ‚îÄ‚îÄ Essay entries ‚îÄ‚îÄ‚îÄ -->
  {% if section_name == 'Essays' %}
    {% for article in articles %}
    <div style="border-left:4px solid #764ba2; padding:0 0 0 16px; margin-bottom:20px;">
      {% if article.url %}
      <h3 style="margin:0 0 4px; font-size:15px;"><a href="{{ article.url }}" style="color:#667eea; text-decoration:none;">{{ article.title }}</a></h3>
      {% else %}
      <h3 style="margin:0 0 4px; font-size:15px; color:#1a1a2e;">{{ article.title }}</h3>
      {% endif %}

      <p style="margin:0 0 6px; font-size:12px; color:#888;">{{ article.newsletter_name }}</p>

      {% if article.summary %}
      <p style="margin:0; font-size:14px; color:#444; line-height:1.5;">{{ article.summary }}</p>
      {% endif %}
    </div>
    {% endfor %}

  <!-- ‚îÄ‚îÄ‚îÄ Link entries ‚îÄ‚îÄ‚îÄ -->
  {% else %}
    {% for article in articles %}
    <div style="margin-bottom:18px;">
      {% if article.url %}
      <h3 style="margin:0 0 3px; font-size:15px;"><a href="{{ article.url }}" style="color:#1a1a2e; text-decoration:none; font-weight:600;">{{ article.title }}</a></h3>
      {% else %}
      <h3 style="margin:0 0 3px; font-size:15px; color:#1a1a2e; font-weight:600;">{{ article.title }}</h3>
      {% endif %}

      <p style="margin:0 0 4px; font-size:12px; color:#888;">{{ article.newsletter_name }}</p>

      {% if article.blurb %}
      <p style="margin:0; font-size:14px; color:#555; line-height:1.45;">{{ article.blurb }}</p>
      {% endif %}
    </div>

    <!-- Thin divider between entries, except after the last one -->
    {% if not loop.last %}
    <hr style="border:none; border-top:1px solid #eff0f3; margin:0 0 18px;">
    {% endif %}
    {% endfor %}
  {% endif %}

</td>
</tr>
{% endfor %}

<!-- ‚îÄ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ‚îÄ -->
<tr>
<td style="padding:20px 0; text-align:center;">
  <p style="margin:0; font-size:12px; color:#999;">Generated by Newsletter Digest &middot; {{ date }}</p>
</td>
</tr>

</table><!-- /main column -->
</td></tr>
</table><!-- /outer wrapper -->

</body>
</html>
